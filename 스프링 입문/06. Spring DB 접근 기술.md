# ğŸŒ± Spring DB ì ‘ê·¼ ê¸°ìˆ 

## H2 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì¹˜

ê°œë°œì´ë‚˜ í…ŒìŠ¤íŠ¸ ìš©ë„ë¡œ ê°€ë³ê³  í¸ë¦¬í•œ DB, ì›¹ í™”ë©´ ì œê³µ

- ê¶Œí•œ ì£¼ê¸°  
`chmod 755 h2.sh`
- ì‹¤í–‰  
`./h2.sh`
- ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ ìƒì„± ë°©ë²•  
jdbc:h2:~/test (ìµœì´ˆ í•œë²ˆ)  
~/test.mv.db íŒŒì¼ ìƒì„± í™•ì¸  
ì´í›„ë¶€í„°ëŠ” jdbc:h2:tcp://localhost/~/test ì´ë ‡ê²Œ ì ‘ì†

&nbsp;

## ìˆœìˆ˜ JDBC

### í™˜ê²½ ì„¤ì •

**build.gradle íŒŒì¼ì— jdbc, h2 ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€**

```java
implementation 'org.springframework.boot:spring-boot-starter-jdbc'
runtimeOnly 'com.h2database:h2'
```

JavaëŠ” DBë¥¼ ì—°ê²°í•˜ë ¤ë©´ `jdbc-driver`ê°€ ê¼­ í•„ìš”

**ìŠ¤í”„ë§ ë¶€íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì • ì¶”ê°€**

`resources/application.properties`

```java
spring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
```

ì ‘ì† ì •ë³´ ê²½ë¡œ ë„£ê¸°

### **JDBC íšŒì› ë¦¬íŒŒì§€í† ë¦¬ êµ¬í˜„**

ì´ë ‡ê²Œ JDBC APIë¡œ ì§ì ‘ ì½”ë”©í•˜ëŠ” ê²ƒì€ 20ë…„ ì „ ì´ì•¼ê¸°ì´ë‹¤. ë”°ë¼ì„œ ê³ ëŒ€ ê°œë°œìë“¤ì´ ì´ë ‡ê²Œ ê³ ìƒí•˜ê³  ì‚´ì•˜êµ¬ë‚˜ ìƒê°í•˜ê³ , ì •ì‹ ê±´ê°•ì„ ìœ„í•´ ì°¸ê³ ë§Œ í•˜ê³  ë„˜ì–´ê°€ì.

**Jdbc íšŒì› ë¦¬í¬ì§€í† ë¦¬**

ê¸°ì¡´ì— MemoryMemberRepositoryë¡œ ë§Œë“¤ì–´ë†“ì€ êµ¬í˜„ì²´ë¥¼ dbì™€ ì—°ë™í•˜ê¸° ìœ„í•´ JDBCë¡œ ëŒ€ì²´

DBë¥¼ ë¶™ì´ë ¤ë©´ `dataSource`ê°€ í•„ìš”, Springì—ê²Œ ì£¼ì…ë°›ì•„ì•¼ í•¨  
â†’ `application.properties`ì—ì„œ settingí•´ë†“ì€ ëŒ€ë¡œ Springì´ dataSource ì ‘ì†ì •ë³´ë¥¼ ë§Œë“¤ì–´ë†“ê³  ì£¼ì…í•´ì¤Œ.

```java
private final DataSource dataSource;

public JdbcMemberRepository(DataSource dataSource) {
		this.dataSource = dataSource;
}
```

**ìŠ¤í”„ë§ ì„¤ì • ë³€ê²½**

```java
@Configuration
public class SpringConfig {

    private final DataSource dataSource;

    @Autowired
    public SpringConfig(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    @Bean
    public MemberService memberService() {
        return new MemberService(memberRepository());
    }

    @Bean
    public MemberRepository memberRepository() {
        return new JdbcMemberRepository(dataSource);
    }
}
```

- DataSourceëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ì„ íšë“í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê°ì²´ë‹¤.  
ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ DataSourceë¥¼ ìƒì„±í•˜ê³  ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë§Œë“¤ì–´ë‘”ë‹¤. ê·¸ë˜ì„œ DIë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.
- JdbcMemberRepositoryë§Œ ìƒì„±í•˜ê³ , Configë§Œ ë°”ê¿”ì£¼ë©´ ë‹¤ë¥¸ ì½”ë“œë¥¼ ìˆ˜ì •í•  í•„ìš” ì—†ì´ MemberRepository êµ¬í˜„ì²´ë¥¼ ë³€ê²½ ê°€ëŠ¥  
â†’ interfaceëŠ” ê·¸ëŒ€ë¡œ ë‘ê³  êµ¬í˜„ì²´ë¥¼ ë°”ê¿€ ìˆ˜ ìˆë‹¤. (ë‹¤í˜•ì„± í™œìš©)

    <img width="836" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-01-22 á„‹á…©á„’á…® 2 09 47" src="https://user-images.githubusercontent.com/45806836/105449312-7d8d8b00-5cbb-11eb-9813-788a95366a80.png">

- ê°œë°©-íì‡„ ì›ì¹™(**OCP**, Open-Closed Principle)  
â†’ í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³ , ìˆ˜ì •, ë³€ê²½ì—ëŠ” ë‹«í˜€ìˆë‹¤.
- ìŠ¤í”„ë§ì˜ **DI** (Dependencies Injection)ì„ ì‚¬ìš©í•˜ë©´ **ê¸°ì¡´ ì½”ë“œë¥¼ ì „í˜€ ì†ëŒ€ì§€ ì•Šê³ , ì„¤ì •ë§Œìœ¼ë¡œ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ë³€ê²½**í•  ìˆ˜ ìˆë‹¤.
- ë°ì´í„°ë¥¼ DBì— ì €ì¥í•˜ë¯€ë¡œ ìŠ¤í”„ë§ ì„œë²„ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•´ë„ ë°ì´í„°ê°€ ì•ˆì „í•˜ê²Œ ì €ì¥ëœë‹¤.

&nbsp;

## ìŠ¤í”„ë§ í†µí•© í…ŒìŠ¤íŠ¸

ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì™€ DBê¹Œì§€ ì—°ê²°í•œ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³´ì.

```java
@SpringBootTest
@Transactional
class MemberServiceIntegrationTest {

    @Autowired MemberService memberService;
    @Autowired MemberRepository memberRepository;

		...

}
```

*@SpringBootTest* : ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì™€ í…ŒìŠ¤íŠ¸ë¥¼ í•¨ê»˜ ì‹¤í–‰í•œë‹¤.

*@Transactional* : í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— ì´ ì• ë…¸í…Œì´ì…˜ì´ ìˆìœ¼ë©´, í…ŒìŠ¤íŠ¸ ì‹œì‘ ì „ì— íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê³ , í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„ì— í•­ìƒ ë¡¤ë°±í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ DBì— ë°ì´í„°ê°€ ë‚¨ì§€ ì•Šìœ¼ë¯€ë¡œ ë‹¤ìŒ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.

ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ì£¼ë¡œ ì„œë¹„ìŠ¤ ë¡œì§ì— ì ìš©í•œë‹¤. ê·¸ëŸ°ë° DBë¥¼ ì—°ë™í•˜ë©´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ì–´ë ¤ì›Œì§„ë‹¤.  
ê·¸ë˜ì„œ í…ŒìŠ¤íŠ¸ ì „ìš© ê°€ì§œ repositoryë¥¼ ë§Œë“¤ì–´ì„œ í…ŒìŠ¤íŠ¸ ì‹œì ì— ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤. ì´ê²ƒì„ mock ê°ì²´ë¼ê³  í•œë‹¤.  
ë‹¨ìˆœíˆ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œ ì§„ì§œ dbê°€ ì•„ë‹ˆë¼ ê°€ì§œ ê°ì²´ë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ì„œ ë„£ì–´ì£¼ëŠ” ê²ƒì´ë‹¤.  
ê·¸ëŸ°ë° ì¼ì¼ì´ ì´ëŸ° ê°ì²´ë¥¼ ë§Œë“¤ë©´ ê°œë°œìê°€ ë„ˆë¬´ ê·€ì°®ìœ¼ë‹ˆê¹Œ ì‹¤ë¬´ì—ì„œëŠ” mockito ê°™ì€ ê°€ì§œ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.

&nbsp;

## ìŠ¤í”„ë§ JdbcTemplate

ìŠ¤í”„ë§ JdbcTemplateê³¼ MyBatis ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” JDBC APIì—ì„œ ë³¸ ë°˜ë³µ ì½”ë“œë¥¼ ëŒ€ë¶€ë¶„ ì œê±°í•´ì¤€ë‹¤. í•˜ì§€ë§Œ SQLì€ ì§ì ‘ ì‘ì„±í•´ì•¼ í•œë‹¤.

```java
private final JdbcTemplate jdbcTemplate;

@Autowired
public JdbcTemplateMemberRepository(DataSource dataSource) {
		this.jdbcTemplate = new JdbcTemplate(dataSource);
}
```

ì°¸ê³ ) ìƒì„±ìê°€ ë‹¨ í•˜ë‚˜ ì¡´ì¬í•œë‹¤ë©´ @Autowired ìƒëµ ê°€ëŠ¥!

Springìœ¼ë¡œë¶€í„° DataSourceë¥¼ injection ë°›ì•„ JdbcTemplateì„ ë“±ë¡

```java
public class JdbcTemplateMemberRepository implements MemberRepository{

    private final JdbcTemplate jdbcTemplate;

    @Autowired
    public JdbcTemplateMemberRepository(DataSource dataSource) {
        this.jdbcTemplate = new JdbcTemplate(dataSource);
    }

    @Override
    public Member save(Member member) {
        SimpleJdbcInsert jdbcInsert = new SimpleJdbcInsert(jdbcTemplate);
        jdbcInsert.withTableName("member").usingGeneratedKeyColumns("id");
        Map<String, Object> parameters = new HashMap<>();
        parameters.put("name", member.getName());
        Number key = jdbcInsert.executeAndReturnKey(new MapSqlParameterSource(parameters));
        member.setId(key.longValue());
        return member;
    }

    @Override
    public Optional<Member> findById(Long id) {
        List<Member> result = jdbcTemplate.query("select * from MEMBER where id = ?", memberRowMapper(), id);
        return result.stream().findAny();
    }

    @Override
    public Optional<Member> findByName(String name) {
        List<Member> result = jdbcTemplate.query("select * from MEMBER where name = ?", memberRowMapper(), name);
        return result.stream().findAny();
    }

    @Override
    public List<Member> findAll() {
        return jdbcTemplate.query("select * from MEMBER", memberRowMapper());
    }

    private RowMapper<Member> memberRowMapper() {
        return (rs, rowNum) -> {
            Member member = new Member();
            member.setId(rs.getLong("id"));
            member.setName(rs.getString("name"));
            return member;
        };
    }
}
```

&nbsp;

## JPA

### í™˜ê²½ ì„¤ì •

ê°ì²´ë¥¼ ë©”ëª¨ë¦¬ì— ë„£ë“¯ì´ JPAì— ì§‘ì–´ë„£ìœ¼ë©´, JPAê°€ ì¤‘ê°„ì—ì„œ DBì— sqlë¬¸ë“¤ì„ ì‹¤í–‰í•˜ê³ , DBë¥¼ í†µí•´ dataë¥¼ ê°€ì ¸ì˜¤ê¸°ê¹Œì§€ í•´ì¤€ë‹¤.

- JPAëŠ” ê¸°ì¡´ì˜ ë°˜ë³µ ì½”ë“œëŠ” ë¬¼ë¡ ì´ê³ , ê¸°ë³¸ì ì¸ SQLë„ JPAê°€ ì§ì ‘ ë§Œë“¤ì–´ì„œ ì‹¤í–‰í•´ì¤€ë‹¤.
- JPAë¥¼ ì‚¬ìš©í•˜ë©´, SQLê³¼ ë°ì´í„° ì¤‘ì‹¬ì˜ ì„¤ê³„ì—ì„œ ê°ì²´ ì¤‘ì‹¬ì˜ ì„¤ê³„ë¡œ íŒ¨ëŸ¬ë‹¤ì„ì„ ì „í™˜ í•  ìˆ˜ ìˆë‹¤.
- JPAë¥¼ ì‚¬ìš©í•˜ë©´ ê°œë°œ ìƒì‚°ì„±ì„ í¬ê²Œ ë†’ì¼ ìˆ˜ ìˆë‹¤.

**build.gradle íŒŒì¼ì— JPA ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€**

```java
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
```

`spring-boot-starter-data-jpa`ëŠ” ë‚´ë¶€ì— jdbc ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í¬í•¨í•œë‹¤. ë”°ë¼ì„œ jdbcëŠ” ì œê±°í•´ë„ ëœë‹¤. ë˜í•œ ìŠ¤í”„ë§ì´ ìë™ìœ¼ë¡œ ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ìƒì„±í•´ ì¤€ë‹¤.

**ìŠ¤í”„ë§ ë¶€íŠ¸ì— JPA ì„¤ì • ì¶”ê°€**

`resources/application.properties`

```java
spring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=none
```

`spring.jpa.show-sql=true`: JPAê°€ ìƒì„±í•˜ëŠ” SQLì„ ì¶œë ¥í•œë‹¤.

`ddl-auto`: JPAëŠ” í…Œì´ë¸”ì„ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ”ë°, `none` ì„ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ê¸°ëŠ¥ì„ ëˆë‹¤.  
`create`ë¥¼ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹° ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í…Œì´ë¸”ë„ ì§ì ‘ ìƒì„±í•´ì¤€ë‹¤.

### ì—”í‹°í‹° ë§¤í•‘

JPAëŠ” ìë°” ì§„ì˜ì˜ í‘œì¤€ ì¸í„°í˜ì´ìŠ¤, êµ¬í˜„ì²´ ì¤‘ í•˜ë‚˜ê°€ hibernate

JPAëŠ” ìë°” ORM (Object-Relational database-Mapping) by ì• ë…¸í…Œì´ì…˜

- ***@Entity** ê°ì²´ì™€ í…Œì´ë¸” ë§¤í•‘*

: JPAë¥¼ ì‚¬ìš©í•´ í…Œì´ë¸”ê³¼ ë§¤í•‘í•  í´ë˜ìŠ¤ëŠ” `@Entity` ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì•¼ í•œë‹¤.  
`@Entity`ê°€ ë¶™ì€ í´ë˜ìŠ¤ëŠ” JPAê°€ ê´€ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ, ì—”í‹°í‹°ë¼ ë¶€ë¥¸ë‹¤.

- ***@Id** ê¸°ë³¸ í‚¤(Primary Key) ë§¤í•‘*
- ***@GeneratedValue(strategy = GenerationType.IDENTITY)***

: ê¸°ë³¸ í‚¤ ìƒì„±ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìœ„ì„í•˜ëŠ” ì „ëµ.  
DBì— ê°’ì„ ë„£ìœ¼ë©´ DBê°€ Idë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ì£¼ëŠ” ê²ƒì„ IDENTITYì „ëµì´ë¼ê³  í•œë‹¤.

- ***@Column(name = "username")** í•„ë“œì™€ ì»¬ëŸ¼ ë§¤í•‘*

```java
@Entity
public class Member {

    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(name = "username")
    private String name;

		...
} 
```

### ì—”í‹°í‹° ë§¤ë‹ˆì €

JPAëŠ” ì—”í‹°í‹° ë§¤ë‹ˆì €ë¡œ ëª¨ë“  ê²ƒì´ ë™ì‘í•œë‹¤.  
ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ì‚¬ìš©í•´ ì—”í‹°í‹°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ë“±ë¡/ìˆ˜ì •/ì‚­ì œ/ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.  
ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ë‚´ë¶€ì— ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜(ë°ì´í„° ì†ŒìŠ¤)ë¥¼ ìœ ì§€í•˜ë©´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ í†µì‹ í•œë‹¤.

ê²°ë¡ ì€ JPAë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ EntityManagerë¥¼ ì£¼ì… ë°›ì•„ì•¼ í•œë‹¤.

```java
public class JpaMemberRepository implements MemberRepository {

    private final EntityManager entityManager;

    public JpaMemberRepository(EntityManager entityManager) {
        this.entityManager = entityManager;
    }

		...
}
```

### JPQL

```java
@Override
    public List<Member> findAll() {
        return entityManager.createQuery("select m from Member m", Member.class)
                .getResultList();
    }
```

### ì„œë¹„ìŠ¤ ê³„ì¸µì— íŠ¸ëœì­ì…˜ ì¶”ê°€

```java
import org.springframework.transaction.annotation.Transactional

@Transactional
public class MemberService {}
```

íŠ¸ëœì­ì…˜: ë°ì´í„°ë² ì´ìŠ¤ì˜ ìƒíƒœë¥¼ ë³€í™”ì‹œí‚¤ê¸° ìœ„í•´ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…ì˜ ë‹¨ìœ„

Commit: í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì´ ì„±ê³µì ìœ¼ë¡œ ëë‚¬ê³ , ë°ì´í„°ë² ì´ìŠ¤ê°€ ì¼ê´€ì„± ìˆëŠ” ìƒíƒœì— ìˆì„ ë•Œ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì´ ëë‚¬ë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ëŠ” ì—°ì‚°. ìˆ˜í–‰í–ˆë˜ íŠ¸ëœì­ì…˜ì´ ë¡œê·¸ì— ì €ì¥ë˜ë©°, í›„ì— íŠ¸ëœì­ì…˜ ë‹¨ìœ„ë¡œ Rollbackí•˜ëŠ” ê²ƒì„ ë„ì™€ì¤€ë‹¤.

RollBack: í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë˜ì–´ ì›ìì„±ì´ ê¹¨ì§„ ê²½ìš°, íŠ¸ëœì­ì…˜ì„ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•˜ê±°ë‚˜, ë¶€ë¶„ì ìœ¼ë¡œë§Œ ì—°ì‚°ëœ ê²°ê³¼ë¥¼ ë‹¤ì‹œ ì·¨ì†Œ ì‹œí‚¨ë‹¤.

***@Transactional*** ë°ì´í„°ë¥¼ ì €ì¥í•˜ê±°ë‚˜ ë³€ê²½í•  ë•Œ í•­ìƒ íŠ¸ëœì­ì…˜ì´ ìˆì–´ì•¼ í•œë‹¤. (íšŒì› ê°€ì…ì— í•„ìš”)

`org.springframework.transaction.annotation.Transactional`
ìŠ¤í”„ë§ì€ í•´ë‹¹ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•  ë•Œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê³ , ë©”ì„œë“œê°€ ì •ìƒ ì¢…ë£Œë˜ë©´ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•œë‹¤. ë§Œì•½ ëŸ°íƒ€ì„ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ë¡¤ë°±í•œë‹¤.  
**JPAë¥¼ í†µí•œ ëª¨ë“  ë°ì´í„° ë³€ê²½ì€ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì‹¤í–‰í•´ì•¼ í•œë‹¤.**

### JPAë¥¼ ì‚¬ìš©í•˜ë„ë¡ ìŠ¤í”„ë§ ì„¤ì • ë³€ê²½

```java
@Configuration
public class SpringConfig {

    private EntityManager entityManager;

    public SpringConfig(EntityManager entityManager) {
        this.entityManager = entityManager;
    }

    ...

    @Bean
    public MemberRepository memberRepository() {
        return new JpaMemberRepository(entityManager);
    }
}
```

&nbsp;

## ìŠ¤í”„ë§ ë°ì´í„° JPA

ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ JPAë§Œ ì‚¬ìš©í•´ë„ ê°œë°œ ìƒì‚°ì„±ì´ ì •ë§ ë§ì´ ì¦ê°€í•˜ê³ , ê°œë°œí•´ì•¼í•  ì½”ë“œë„ í™•ì—°íˆ ì¤„ì–´ë“ ë‹¤.  
ì—¬ê¸°ì— ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©í•˜ë©´, ê¸°ì¡´ì˜ í•œê³„ë¥¼ ë„˜ì–´ ë§ˆì¹˜ ë§ˆë²•ì²˜ëŸ¼, ë¦¬í¬ì§€í† ë¦¬ì— êµ¬í˜„ í´ë˜ìŠ¤ ì—†ì´
ì¸í„°í˜ì´ìŠ¤ ë§Œìœ¼ë¡œ ê°œë°œì„ ì™„ë£Œí•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ë°˜ë³µ ê°œë°œí•´ì˜¨ ê¸°ë³¸ CRUD ê¸°ëŠ¥ë„ ìŠ¤í”„ë§ ë°ì´í„°
JPAê°€ ëª¨ë‘ ì œê³µí•œë‹¤. 

ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ JPAë¼ëŠ” ê¸°ë°˜ ìœ„ì—, ìŠ¤í”„ë§ ë°ì´í„° JPAë¼ëŠ” í™˜ìƒì ì¸ í”„ë ˆì„ì›Œí¬ë¥¼ ë”í•˜ë©´ ê°œë°œì´ ì •ë§
ì¦ê±°ì›Œì§„ë‹¤. ì§€ê¸ˆê¹Œì§€ ì¡°ê¸ˆì´ë¼ë„ ë‹¨ìˆœí•˜ê³  ë°˜ë³µì´ë¼ ìƒê°í–ˆë˜ ê°œë°œ ì½”ë“œë“¤ì´ í™•ì—°í•˜ê²Œ ì¤„ì–´ë“ ë‹¤.  
ë”°ë¼ì„œ ê°œë°œìëŠ” í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ê°œë°œí•˜ëŠ”ë°, ì§‘ì¤‘í•  ìˆ˜ ìˆë‹¤.  
ì‹¤ë¬´ì—ì„œ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ì´ì œ ì„ íƒì´ ì•„ë‹ˆë¼ í•„ìˆ˜ë‹¤.

> ì£¼ì˜: **ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” JPAë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” ê¸°ìˆ ì´ë‹¤.  
ë”°ë¼ì„œ JPAë¥¼ ë¨¼ì € í•™ìŠµí•œ í›„ì— ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ í•™ìŠµí•´ì•¼ í•œë‹¤.**

### ìŠ¤í”„ë§ ë°ì´í„° JPA íšŒì› ë¦¬í¬ì§€í† ë¦¬

```java
public interface SpringDataJpaMemberRepository extends JpaRepository<Member, Long>, MemberRepository {
    
    @Override
    Optional<Member> findByName(String name);
}
```

Interfaceë¡œ ìƒì„±. Interfaceê°€ Interfaceë¥¼ í™•ì¥í•  ë• extends.  
Spring Data Jpaê°€ `JpaRepository`ë¥¼ í™•ì¥í•˜ë©´, êµ¬í˜„ì²´ë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ Beanì— ë“±ë¡ â†’ ê°€ì ¸ë‹¤ ì“´ë‹¤.

`,`ë¡œ êµ¬ë¶„í•˜ì—¬ MemberRepositoryë„ ë‹¤ì¤‘ ìƒì†.

**ìŠ¤í”„ë§ ë°ì´í„° JPA íšŒì› ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ìŠ¤í”„ë§ ì„¤ì • ë³€ê²½**

```java
@Configuration
public class SpringConfig {

    private final MemberRepository memberRepository;

    @Autowired
    public SpringConfig(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    @Bean
    public MemberService memberService() {
        return new MemberService(memberRepository);
    }
}
```

ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ `SpringDataJpaMemberRepository`ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡í•´ì¤€ë‹¤.

**ìŠ¤í”„ë§ ë°ì´í„° JPA ì œê³µ í´ë˜ìŠ¤**

<img width="666" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-01-24 á„‹á…©á„’á…® 4 35 43" src="https://user-images.githubusercontent.com/45806836/105624080-37266080-5e62-11eb-9f99-2e0f31db27ff.png">

**ìŠ¤í”„ë§ ë°ì´í„° JPA ì œê³µ ê¸°ëŠ¥**

- ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ ê¸°ë³¸ì ì¸ CRUD

`findByName()` , `findByEmail()` ì²˜ëŸ¼ ë©”ì„œë“œ ì´ë¦„ ë§Œìœ¼ë¡œ ì¡°íšŒ ê¸°ëŠ¥ ì œê³µ

- í˜ì´ì§• ê¸°ëŠ¥ ìë™ ì œê³µ

ì°¸ê³ : ì‹¤ë¬´ì—ì„œëŠ” JPAì™€ ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , ë³µì¡í•œ ë™ì  ì¿¼ë¦¬ëŠ” Querydslì´ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.  
Querydslì„ ì‚¬ìš©í•˜ë©´ ì¿¼ë¦¬ë„ ìë°” ì½”ë“œë¡œ ì•ˆì „í•˜ê²Œ ì‘ì„±í•  ìˆ˜ ìˆê³ , ë™ì  ì¿¼ë¦¬ë„ í¸ë¦¬í•˜ê²Œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.  
ì´ ì¡°í•©ìœ¼ë¡œ í•´ê²°í•˜ê¸° ì–´ë ¤ìš´ ì¿¼ë¦¬ëŠ” JPAê°€ ì œê³µí•˜ëŠ” ë„¤ì´í‹°ë¸Œ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜, ì•ì„œ í•™ìŠµí•œ ìŠ¤í”„ë§ JdbcTemplateë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
